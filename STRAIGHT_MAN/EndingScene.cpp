#include "EndingScene.h"
#include "ConsoleFunctions.h"
#include "SceneManager.h"

#include "MainScene.h"

EndingScene::EndingScene(int star)
{
	this->star = star;
}

EndingScene::~EndingScene()
{

}

void EndingScene::Start() {

	PrintClearLogo();
	PrintMessage();
	SelectMenu();

}

void EndingScene::PrintClearLogo() {

	logoArray[0]  = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[1]  = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[2]  = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[3]  = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[4]  = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[5]  = "00000000000000000001111111110011111111100111111111001111111110000000000000000000";
	logoArray[6]  = "00000000000000000001000000010010000000100100010001001000000000000000000000000000";
	logoArray[7]  = "00000000000000000001000000010010000000100100010001001000000000000000000000000000";
	logoArray[8]  = "00000000000000000001000000000010000000100100010001001000000000000000000000000000";
	logoArray[9]  = "00000000000000000001000000000011111111100100010001001111111110000000000000000000";
	logoArray[10] = "00000000000000000001000011110010000000100100010001001000000000000000000000000000";
	logoArray[11] = "00000000000000000001000000010010000000100100010001001000000000000000000000000000";
	logoArray[12] = "00000000000000000001000000010010000000100100010001001000000000000000000000000000";
	logoArray[13] = "00000000000000000001111111110010000000100100010001001111111110000000000000000000";
	logoArray[14] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[15] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[16] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[17] = "00000000000001111111110010000000000111111111001111111110011111111100000000000000";
	logoArray[18] = "00000000000001000000000010000000000100000000001000000010010000000100000000000000";
	logoArray[19] = "00000000000001000000000010000000000100000000001000000010010000000100000000000000";
	logoArray[20] = "00000000000001000000000010000000000100000000001000000010010000000100000000000000";
	logoArray[21] = "00000000000001000000000010000000000111111111001111111110011111111100000000000000";
	logoArray[22] = "00000000000001000000000010000000000100000000001000000010010000001000000000000000";
	logoArray[23] = "00000000000001000000000010000000000100000000001000000010010000000100000000000000";
	logoArray[24] = "00000000000001000000000010000000000100000000001000000010010000000100000000000000";
	logoArray[25] = "00000000000001111111110011111111100111111111001000000010010000000100000000000000";
	logoArray[26] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[27] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[28] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[29] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[30] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[31] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[32] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[33] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[34] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[35] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[36] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[37] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[38] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[39] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[40] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[41] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[42] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[43] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";
	logoArray[44] = "00000000000000000000000000000000000000000000000000000000000000000000000000000000";

	for (int y = 0; y < 45; y++) {
		for (int x = 0; x < 80; x++) {
			if (logoArray[y][x] == '0') {
				setBackgroundColor(ColorBlack);
			}
			else {
				setBackgroundColor(ColorWhite);
			}
			gotoxy(x * 2, y);
			std::cout << "  ";
		}
	}

}

void EndingScene::PrintMessage() {

	setBackgroundColor(ColorBlack);
	if (star == 54) {
		gotoxy(69, 29);
		std::cout << "모은 별의 개수 : " << star << "개";
	}
	else {
		gotoxy(67, 29);
		std::cout << "모은 별의 개수 : 겨우 " << star << "개?";
	}

	gotoxy(74, 31);
	std::cout << "20626 홍성목";

	gotoxy(0, 44);
	std::cout << "방향키 (WASD) : 이동 | 스페이스바 : 선택";

}

void EndingScene::SelectMenu() {

	setBackgroundColor(ColorBlack);
	gotoxy(76, 35);
	std::cout << "메인화면";
	gotoxy(78, 38);
	std::cout << "종료";

	int currentSelect = 0;

	gotoxy(72, 35);
	std::cout << ">>";

	while (true) {
		if (_kbhit()) {
			char key = _getch();
			if (key == 32) { //스페이스바
				if (currentSelect == 0) {
					SceneManager::ChangeScene(new MainScene());
					break;
				}
				else {
					SceneManager::ExitGame();
					break;
				}
			}
			else if (key == 72 || key == 'w' || key == 'W') { //위 방향키
				if (currentSelect == 1) {
					currentSelect = 0;
					gotoxy(74, 38);
					std::cout << "  ";
					gotoxy(72, 35);
					std::cout << ">>";
				}
			}
			else if (key == 80 || key == 's' || key == 'S') {
				if (currentSelect == 0) {
					currentSelect = 1;
					gotoxy(72, 35);
					std::cout << "  ";
					gotoxy(74, 38);
					std::cout << ">>";
				}
			}
		}
	}

}